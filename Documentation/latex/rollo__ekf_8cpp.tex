\hypertarget{rollo__ekf_8cpp}{}\section{/home/emeres/.hdd/\+Documents/\+Studia/\+Università degli studi di Genova/\+D\+I\+B\+R\+I\+S/\+Tutti i corsi/86805 -\/ S\+O\+F\+T\+W\+A\+R\+E A\+R\+C\+H\+I\+T\+E\+C\+T\+U\+R\+E\+S F\+O\+R R\+O\+B\+O\+T\+I\+C\+S/\+A\+S01/rollo/src/rollo\+\_\+ekf.cpp File Reference}
\label{rollo__ekf_8cpp}\index{/home/emeres/.\+hdd/\+Documents/\+Studia/\+Università degli studi di Genova/\+D\+I\+B\+R\+I\+S/\+Tutti i corsi/86805 -\/ S\+O\+F\+T\+W\+A\+R\+E A\+R\+C\+H\+I\+T\+E\+C\+T\+U\+R\+E\+S F\+O\+R R\+O\+B\+O\+T\+I\+C\+S/\+A\+S01/rollo/src/rollo\+\_\+ekf.\+cpp@{/home/emeres/.\+hdd/\+Documents/\+Studia/\+Università degli studi di Genova/\+D\+I\+B\+R\+I\+S/\+Tutti i corsi/86805 -\/ S\+O\+F\+T\+W\+A\+R\+E A\+R\+C\+H\+I\+T\+E\+C\+T\+U\+R\+E\+S F\+O\+R R\+O\+B\+O\+T\+I\+C\+S/\+A\+S01/rollo/src/rollo\+\_\+ekf.\+cpp}}


E\+K\+F implementation for localisation of the robot.  


{\ttfamily \#include \char`\"{}ros/ros.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}std\+\_\+msgs/\+String.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}std\+\_\+msgs/\+Header.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}geometry\+\_\+msgs/\+Pose.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}geometry\+\_\+msgs/\+Pose2\+D.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}tf/tf.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}rollo/\+Pose2\+D\+Stamped.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}rollo/\+Wheel\+Speed.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}rollo/\+E\+K\+F.\+h\char`\"{}}\\*
{\ttfamily \#include $<$sstream$>$}\\*
{\ttfamily \#include $<$iostream$>$}\\*
{\ttfamily \#include $<$eigen3/\+Eigen/\+Dense$>$}\\*
{\ttfamily \#include \char`\"{}rollo.\+hpp\char`\"{}}\\*
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
void \hyperlink{rollo__ekf_8cpp_a52396abb9d94db28c626fab5c6fb2d9f}{subscriber\+Callback\+Measurement} (const rollo\+::\+Pose2\+D\+Stamped msg)
\begin{DoxyCompactList}\small\item\em Subscriber\+Callback\+Measurement. \end{DoxyCompactList}\item 
void \hyperlink{rollo__ekf_8cpp_ae1074d5c031527169ff7e98a7ee5bf4f}{subscriber\+Callback\+Control\+Input} (const rollo\+::\+Wheel\+Speed msg)
\item 
rollo\+::\+Wheel\+Speed \hyperlink{rollo__ekf_8cpp_aa7ba3e9c14d99e7236bdd72463308527}{interpolate\+Odometry} (rollo\+::\+Wheel\+Speed Odometryold, rollo\+::\+Wheel\+Speed Odometrynew, double E\+K\+Ffilter\+Time\+Secs)
\begin{DoxyCompactList}\small\item\em Linear interpolation of values from odometry. \end{DoxyCompactList}\item 
rollo\+::\+Pose2\+D\+Stamped \hyperlink{rollo__ekf_8cpp_a24a88dd7d370fcb6c7040458b2b05b8b}{interpolate\+Measurement} (rollo\+::\+Pose2\+D\+Stamped z\+Old, rollo\+::\+Pose2\+D\+Stamped z\+New, double E\+K\+Ffilter\+Time\+Secs)
\begin{DoxyCompactList}\small\item\em Linear interpolation of values from measurement (motion capture) \end{DoxyCompactList}\item 
Eigen\+::\+Vector3d \hyperlink{rollo__ekf_8cpp_a0a7fb5aa6464ed1efefad765828d0015}{F\+S\+T\+A\+T\+E} (Eigen\+::\+Vector3d x\+\_\+pp, Eigen\+::\+Vector2d u)
\begin{DoxyCompactList}\small\item\em F\+S\+T\+A\+T\+E nonlinear state equations, f(x\+\_\+k-\/1, u\+\_\+k-\/1) \end{DoxyCompactList}\item 
Eigen\+::\+Matrix3d \hyperlink{rollo__ekf_8cpp_acad14776c403d91313295446350809c4}{Jacobian\+F\+S\+T\+A\+T\+E} (Eigen\+::\+Vector3d x\+\_\+pp, Eigen\+::\+Vector2d u)
\begin{DoxyCompactList}\small\item\em Jacobian\+F\+S\+T\+A\+T\+E. \end{DoxyCompactList}\item 
Eigen\+::\+Vector3d \hyperlink{rollo__ekf_8cpp_a1db8c3c5c87b81f565785543f1ae2048}{H\+M\+E\+A\+S} (Eigen\+::\+Vector3d x\+\_\+cp)
\begin{DoxyCompactList}\small\item\em H\+M\+E\+A\+S measurement equation, h(x\+\_\+k) \end{DoxyCompactList}\item 
int \hyperlink{rollo__ekf_8cpp_a3c04138a5bfe5d72780bb7e82a18e627}{main} (int argc, char $\ast$$\ast$argv)
\begin{DoxyCompactList}\small\item\em Main function. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Variables}
\begin{DoxyCompactItemize}
\item 
rollo\+::\+Pose2\+D\+Stamped \hyperlink{rollo__ekf_8cpp_a09ad376aec92d33ec8b8e24e57a7d145}{z\+Pose2\+D\+Stamped}
\begin{DoxyCompactList}\small\item\em Global variables updated in the Subscriber\+Callback functions. \end{DoxyCompactList}\item 
\hypertarget{rollo__ekf_8cpp_a7353cc288b8b9991c982cd1d6eb00027}{}double {\bfseries z\+Time\+Secs} = 0\label{rollo__ekf_8cpp_a7353cc288b8b9991c982cd1d6eb00027}

\item 
\hypertarget{rollo__ekf_8cpp_a3f9fc835d4f739424baa6f27358e7915}{}rollo\+::\+Wheel\+Speed {\bfseries Odometry}\label{rollo__ekf_8cpp_a3f9fc835d4f739424baa6f27358e7915}

\item 
\hypertarget{rollo__ekf_8cpp_af3a8e6902562d4ccb9a61207508b1d64}{}double {\bfseries Odometry\+Time\+Secs} = 0\label{rollo__ekf_8cpp_af3a8e6902562d4ccb9a61207508b1d64}

\item 
\hypertarget{rollo__ekf_8cpp_ac9c755d41ea44e27fdce963bd3ac8d50}{}char {\bfseries Node\+Name} \mbox{[}20\mbox{]} = C1 K\+F \hyperlink{rollo_8hpp_a876ce77f3c672c7162658151e648389e}{C\+R}\label{rollo__ekf_8cpp_ac9c755d41ea44e27fdce963bd3ac8d50}

\item 
\hypertarget{rollo__ekf_8cpp_a87885b647cee6d9abf5ffe12fdb33add}{}char \hyperlink{rollo__ekf_8cpp_a87885b647cee6d9abf5ffe12fdb33add}{Topic\+E\+K\+F} \mbox{[}64\mbox{]} = T\+O\+P\+I\+C\+\_\+\+E\+K\+F\label{rollo__ekf_8cpp_a87885b647cee6d9abf5ffe12fdb33add}

\begin{DoxyCompactList}\small\item\em Topics. \end{DoxyCompactList}\item 
\hypertarget{rollo__ekf_8cpp_a22cba6fb9ef3df1b681601efb5ccbc2c}{}char {\bfseries Topic\+Wheel\+Speed} \mbox{[}64\mbox{]} = \hyperlink{rollo_8hpp_ae7e7dd1f59a7dec839d19825d873e077}{T\+O\+P\+I\+C\+\_\+\+C\+O\+M\+M\+\_\+\+W\+S}\label{rollo__ekf_8cpp_a22cba6fb9ef3df1b681601efb5ccbc2c}

\item 
\hypertarget{rollo__ekf_8cpp_a85ec1e73270d9a2e4219bbd70a6def15}{}char {\bfseries Topic\+Pose2\+D\+Stamped} \mbox{[}64\mbox{]} = T\+O\+P\+I\+C\+\_\+\+P\+R\+E\+P\+\_\+\+P2\+D\+T\label{rollo__ekf_8cpp_a85ec1e73270d9a2e4219bbd70a6def15}

\end{DoxyCompactItemize}


\subsection{Detailed Description}
E\+K\+F implementation for localisation of the robot. 

\begin{DoxyAuthor}{Author}
Rabbia Asghar, Ernest Skrzypczyk 
\end{DoxyAuthor}
\begin{DoxyDate}{Date}
20/2/16
\end{DoxyDate}
Takes control input from communication node and measurement from preprocessor node, implements Extended Kalman Filter for the estimation of states and publishes estimated state. For localisation of the robot there are 3 states\+: position (x, y), orientation (Theta).

Timing for E\+K\+F update is inspired from Robot Pose E\+K\+F (robot/pose/ekf) package available for R\+O\+S\+: Timings and data at those specific time instants are synchronized in such a manner, that the latest measurements with newer timestamps are interpolated to one and the same timestamp, where all necessary data is available. This allows for a relative comparison of available data, even though an additional error is introduced through interpolating. \begin{DoxySeeAlso}{See also}
\href{http://wiki.ros.org/robot_pose_ekf}{\tt http\+://wiki.\+ros.\+org/robot\+\_\+pose\+\_\+ekf}
\end{DoxySeeAlso}
Kalman filter equations were first simulated in M\+A\+T\+L\+A\+B and then written in C++ and compared and verified by results in M\+A\+T\+L\+A\+B.

Command\+: rosrun rollo rollo\+\_\+ekf \+\_\+rate\+:=1
\begin{DoxyItemize}
\item rate is the sampling frequency of the node (default\+: 1) \begin{DoxySeeAlso}{See also}
\href{https://github.com/em-er-es/rollo/}{\tt https\+://github.\+com/em-\/er-\/es/rollo/} 
\end{DoxySeeAlso}

\end{DoxyItemize}

\subsection{Function Documentation}
\hypertarget{rollo__ekf_8cpp_a0a7fb5aa6464ed1efefad765828d0015}{}\index{rollo\+\_\+ekf.\+cpp@{rollo\+\_\+ekf.\+cpp}!F\+S\+T\+A\+T\+E@{F\+S\+T\+A\+T\+E}}
\index{F\+S\+T\+A\+T\+E@{F\+S\+T\+A\+T\+E}!rollo\+\_\+ekf.\+cpp@{rollo\+\_\+ekf.\+cpp}}
\subsubsection[{F\+S\+T\+A\+T\+E(\+Eigen\+::\+Vector3d x\+\_\+pp, Eigen\+::\+Vector2d u)}]{\setlength{\rightskip}{0pt plus 5cm}Eigen\+::\+Vector3d F\+S\+T\+A\+T\+E (
\begin{DoxyParamCaption}
\item[{Eigen\+::\+Vector3d}]{x\+\_\+pp, }
\item[{Eigen\+::\+Vector2d}]{u}
\end{DoxyParamCaption}
)}\label{rollo__ekf_8cpp_a0a7fb5aa6464ed1efefad765828d0015}


F\+S\+T\+A\+T\+E nonlinear state equations, f(x\+\_\+k-\/1, u\+\_\+k-\/1) 

This is part of time update(or prediction update) of E\+K\+F. Given \char`\"{}a priori\char`\"{} state estimate, x\+\_\+k-\/1$\vert$k-\/1 and u\+\_\+k-\/1, it computes predicted value for state, x\+\_\+k$\vert$k-\/1. 
\begin{DoxyParams}{Parameters}
{\em x\+\_\+pp} & contains \char`\"{}a priori\char`\"{} state estimate, x\+\_\+k-\/1$\vert$k-\/1. \\
\hline
{\em u} & is control input vector, calculated from odometry. It consists of 2 elements, delta S and delta theta. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Eigen\+::\+Vector3d, state prediction x\+\_\+k$\vert$k-\/1. 
\end{DoxyReturn}
\hypertarget{rollo__ekf_8cpp_a1db8c3c5c87b81f565785543f1ae2048}{}\index{rollo\+\_\+ekf.\+cpp@{rollo\+\_\+ekf.\+cpp}!H\+M\+E\+A\+S@{H\+M\+E\+A\+S}}
\index{H\+M\+E\+A\+S@{H\+M\+E\+A\+S}!rollo\+\_\+ekf.\+cpp@{rollo\+\_\+ekf.\+cpp}}
\subsubsection[{H\+M\+E\+A\+S(\+Eigen\+::\+Vector3d x\+\_\+cp)}]{\setlength{\rightskip}{0pt plus 5cm}Eigen\+::\+Vector3d H\+M\+E\+A\+S (
\begin{DoxyParamCaption}
\item[{Eigen\+::\+Vector3d}]{x\+\_\+cp}
\end{DoxyParamCaption}
)}\label{rollo__ekf_8cpp_a1db8c3c5c87b81f565785543f1ae2048}


H\+M\+E\+A\+S measurement equation, h(x\+\_\+k) 

This computes estimated measurement vector based on the latest state estimate.


\begin{DoxyParams}{Parameters}
{\em x\+\_\+cp} & contains state prediction x\+\_\+k$\vert$k-\/1 computed in time update of E\+K\+F \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Eigen\+::\+Vector3d, contains estimated measurement vector. 
\end{DoxyReturn}
\hypertarget{rollo__ekf_8cpp_a24a88dd7d370fcb6c7040458b2b05b8b}{}\index{rollo\+\_\+ekf.\+cpp@{rollo\+\_\+ekf.\+cpp}!interpolate\+Measurement@{interpolate\+Measurement}}
\index{interpolate\+Measurement@{interpolate\+Measurement}!rollo\+\_\+ekf.\+cpp@{rollo\+\_\+ekf.\+cpp}}
\subsubsection[{interpolate\+Measurement(rollo\+::\+Pose2\+D\+Stamped z\+Old, rollo\+::\+Pose2\+D\+Stamped z\+New, double E\+K\+Ffilter\+Time\+Secs)}]{\setlength{\rightskip}{0pt plus 5cm}rollo\+::\+Pose2\+D\+Stamped interpolate\+Measurement (
\begin{DoxyParamCaption}
\item[{rollo\+::\+Pose2\+D\+Stamped}]{z\+Old, }
\item[{rollo\+::\+Pose2\+D\+Stamped}]{z\+New, }
\item[{double}]{E\+K\+Ffilter\+Time\+Secs}
\end{DoxyParamCaption}
)}\label{rollo__ekf_8cpp_a24a88dd7d370fcb6c7040458b2b05b8b}


Linear interpolation of values from measurement (motion capture) 

This function performs linear interpolation of robot pose2\+D for a given time instant. The time for which the robot pose2\+D are computed is defined by E\+K\+Ffilter\+Time\+Secs. 
\begin{DoxyParams}{Parameters}
{\em z\+Old} & contains robot pose2\+D and timestamp read at previous instant when E\+K\+F was updated. \\
\hline
{\em z\+New} & contains robot pose2\+D and timestamp read currently. \\
\hline
{\em E\+K\+Ffilter\+Time\+Secs} & is the time instant for which the E\+K\+F update need to be performed and robot pose2\+D need to be computed. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
rollo\+::\+Pose2\+D\+Stamped, contains robot pose2\+D computed for time instant given by E\+K\+Ffilter\+Time\+Secs using linear interpolation. 
\end{DoxyReturn}
\hypertarget{rollo__ekf_8cpp_aa7ba3e9c14d99e7236bdd72463308527}{}\index{rollo\+\_\+ekf.\+cpp@{rollo\+\_\+ekf.\+cpp}!interpolate\+Odometry@{interpolate\+Odometry}}
\index{interpolate\+Odometry@{interpolate\+Odometry}!rollo\+\_\+ekf.\+cpp@{rollo\+\_\+ekf.\+cpp}}
\subsubsection[{interpolate\+Odometry(rollo\+::\+Wheel\+Speed Odometryold, rollo\+::\+Wheel\+Speed Odometrynew, double E\+K\+Ffilter\+Time\+Secs)}]{\setlength{\rightskip}{0pt plus 5cm}rollo\+::\+Wheel\+Speed interpolate\+Odometry (
\begin{DoxyParamCaption}
\item[{rollo\+::\+Wheel\+Speed}]{Odometryold, }
\item[{rollo\+::\+Wheel\+Speed}]{Odometrynew, }
\item[{double}]{E\+K\+Ffilter\+Time\+Secs}
\end{DoxyParamCaption}
)}\label{rollo__ekf_8cpp_aa7ba3e9c14d99e7236bdd72463308527}


Linear interpolation of values from odometry. 

This function performs linear interpolation of right and left wheel speed for a given time instant. The time for which the odometry values are computed is defined by {\ttfamily E\+K\+Ffilter\+Time\+Secs}. 
\begin{DoxyParams}{Parameters}
{\em Odometryold} & contains left and right wheel speed and timestamp read at previous instant when E\+K\+F was updated. \\
\hline
{\em Odometrynew} & contains left and right wheel speed and timestamp read currently. \\
\hline
{\em E\+K\+Ffilter\+Time\+Secs} & is the time instant for which the E\+K\+F update need to be performed and odometry values need to be computed. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
rollo\+::\+Wheel\+Speed, contains left and right wheel speed \mbox{[}rad/s\mbox{]} computed for time instant given by {\ttfamily E\+K\+Ffilter\+Time\+Secs} using linear interpolation. 
\end{DoxyReturn}
\hypertarget{rollo__ekf_8cpp_acad14776c403d91313295446350809c4}{}\index{rollo\+\_\+ekf.\+cpp@{rollo\+\_\+ekf.\+cpp}!Jacobian\+F\+S\+T\+A\+T\+E@{Jacobian\+F\+S\+T\+A\+T\+E}}
\index{Jacobian\+F\+S\+T\+A\+T\+E@{Jacobian\+F\+S\+T\+A\+T\+E}!rollo\+\_\+ekf.\+cpp@{rollo\+\_\+ekf.\+cpp}}
\subsubsection[{Jacobian\+F\+S\+T\+A\+T\+E(\+Eigen\+::\+Vector3d x\+\_\+pp, Eigen\+::\+Vector2d u)}]{\setlength{\rightskip}{0pt plus 5cm}Eigen\+::\+Matrix3d Jacobian\+F\+S\+T\+A\+T\+E (
\begin{DoxyParamCaption}
\item[{Eigen\+::\+Vector3d}]{x\+\_\+pp, }
\item[{Eigen\+::\+Vector2d}]{u}
\end{DoxyParamCaption}
)}\label{rollo__ekf_8cpp_acad14776c403d91313295446350809c4}


Jacobian\+F\+S\+T\+A\+T\+E. 

This computes Jacobian matrix by taking the partial derivatives of f(x\+\_\+k-\/1,u\+\_\+k-\/1) w.\+r.\+t x 
\begin{DoxyParams}{Parameters}
{\em x\+\_\+pp} & contains \char`\"{}a priori\char`\"{} state estimate, x\+\_\+k-\/1$\vert$k-\/1. \\
\hline
{\em u} & is control input vector, calculated from odometry. It consists of 2 elements, delta S and delta theta. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Eigen\+::\+Matrix3d is the Jacobian matrix 
\end{DoxyReturn}
\hypertarget{rollo__ekf_8cpp_a3c04138a5bfe5d72780bb7e82a18e627}{}\index{rollo\+\_\+ekf.\+cpp@{rollo\+\_\+ekf.\+cpp}!main@{main}}
\index{main@{main}!rollo\+\_\+ekf.\+cpp@{rollo\+\_\+ekf.\+cpp}}
\subsubsection[{main(int argc, char $\ast$$\ast$argv)}]{\setlength{\rightskip}{0pt plus 5cm}int main (
\begin{DoxyParamCaption}
\item[{int}]{argc, }
\item[{char $\ast$$\ast$}]{argv}
\end{DoxyParamCaption}
)}\label{rollo__ekf_8cpp_a3c04138a5bfe5d72780bb7e82a18e627}


Main function. 

Initialize node, nodehandle, subsrcribe to messages from preprocessor and communication nodes and publish estimated state of the robot. Arguments from command line\+: rate.

Initializes Extended Kalman Filter revelant variables. As a part of initializing, function waits for one message from each subscriber and save timestamps for the first iteration of E\+K\+F. State estimate, x\+\_\+(0$\vert$-\/1) is initialized as the first measurement read from the preprocessor node. Covariance of state estimate, E(0, -\/1) is initialized as identity matrix.

Run E\+K\+F in loop, update estimates. Await new sensor data, determine time step for E\+K\+F update and perform necessary interpolation.

Publishes newest estimates of state variables, covariance matrix and timestamp. \begin{DoxyReturn}{Returns}
0 
\end{DoxyReturn}
Initialize node

Initialize nodehandle for subscribers and publisher

Initialize subscribers

Initialize publisher and define topic and message queue size for the publisher

Initialize node arguments using command line

Initialize node parameters from launch file or command line. Use a private node handle so that multiple instances of the node can be run simultaneously while using different parameters.

Publishing rate in units of Hz

Initialize variables involved in computation of E\+K\+F Define number of states

Initialize noise covariances and matrices

Initialize vector for control input u and variables involved in its computation

Initialize state estimate vector \char`\"{}a priori\char`\"{} and measurement vector

Initialize Jacobian matrix with the partial derivatives of h(x\+\_\+k) w.\+r.\+t x, identity for provided system

Initialize E\+\_\+pp\+: \char`\"{}a priori\char`\"{} estimated state covariance, E\+\_\+k-\/1$\vert$k-\/1 (p refers to k-\/1)

Initialize variables involved in the prediction update of E\+K\+F

Initialize variables involved in the innovation update of E\+K\+F

Initialize state estimate vector and state covariance matrix a posteriori

Variables for time

Initialize measurement vector with timestamp and odometry data with timestamp from subscriber messages Initialize state estimate using measurement vector reading

Initialization loop

Initialization loop end

Main loop

Check if new data is available from measurement (motion capture) and odometry (control input)

Determine time step for E\+K\+F update and perform interpolation for the sensor data not available at respective time step

Update timestamp

Interpolate measurements

Update state

Update timestamp

Interpolate for measurement

Update variables involved in E\+K\+F update

Update {\ttfamily prev\+Odometry} and {\ttfamily prevz\+Pose2\+D\+Stamped} for next loop

Perform E\+K\+F update if all sensor data is available

Determine dt

Update Previous\+E\+K\+Ffilter\+Time\+Secs for the next loop

Determine control input u from n\+L and n\+R

Prediction update Nonlinear update and linearization at current state

Partial covariance update

Innovation update Nonlinear measurement and linearization

Update E\+\_\+pp an x\+\_\+pp for next loop for next loop

Prepare data for publishing

Pose2\+D

Covariance

Publish

Synchronize to rate

Main loop end \hypertarget{rollo__ekf_8cpp_ae1074d5c031527169ff7e98a7ee5bf4f}{}\index{rollo\+\_\+ekf.\+cpp@{rollo\+\_\+ekf.\+cpp}!subscriber\+Callback\+Control\+Input@{subscriber\+Callback\+Control\+Input}}
\index{subscriber\+Callback\+Control\+Input@{subscriber\+Callback\+Control\+Input}!rollo\+\_\+ekf.\+cpp@{rollo\+\_\+ekf.\+cpp}}
\subsubsection[{subscriber\+Callback\+Control\+Input(const rollo\+::\+Wheel\+Speed msg)}]{\setlength{\rightskip}{0pt plus 5cm}void subscriber\+Callback\+Control\+Input (
\begin{DoxyParamCaption}
\item[{const rollo\+::\+Wheel\+Speed}]{msg}
\end{DoxyParamCaption}
)}\label{rollo__ekf_8cpp_ae1074d5c031527169ff7e98a7ee5bf4f}
Read new message \hypertarget{rollo__ekf_8cpp_a52396abb9d94db28c626fab5c6fb2d9f}{}\index{rollo\+\_\+ekf.\+cpp@{rollo\+\_\+ekf.\+cpp}!subscriber\+Callback\+Measurement@{subscriber\+Callback\+Measurement}}
\index{subscriber\+Callback\+Measurement@{subscriber\+Callback\+Measurement}!rollo\+\_\+ekf.\+cpp@{rollo\+\_\+ekf.\+cpp}}
\subsubsection[{subscriber\+Callback\+Measurement(const rollo\+::\+Pose2\+D\+Stamped msg)}]{\setlength{\rightskip}{0pt plus 5cm}void subscriber\+Callback\+Measurement (
\begin{DoxyParamCaption}
\item[{const rollo\+::\+Pose2\+D\+Stamped}]{msg}
\end{DoxyParamCaption}
)}\label{rollo__ekf_8cpp_a52396abb9d94db28c626fab5c6fb2d9f}


Subscriber\+Callback\+Measurement. 

Subscribe to the topic \textquotesingle{}/\+Rollo/preprocessor/pose2dstamped\textquotesingle{} of the preprocessor node. Read filtered position and orientation of the robot and timestamp. Update global variables {\ttfamily z\+Pose2\+D\+Stamped} and {\ttfamily z\+Time\+Secs} for use in E\+K\+F update. 
\begin{DoxyParams}{Parameters}
{\em msg} & -\/ custom defined message (preprocessor node). \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
N\+U\+L\+L 
\end{DoxyReturn}
Read new message 

\subsection{Variable Documentation}
\hypertarget{rollo__ekf_8cpp_a09ad376aec92d33ec8b8e24e57a7d145}{}\index{rollo\+\_\+ekf.\+cpp@{rollo\+\_\+ekf.\+cpp}!z\+Pose2\+D\+Stamped@{z\+Pose2\+D\+Stamped}}
\index{z\+Pose2\+D\+Stamped@{z\+Pose2\+D\+Stamped}!rollo\+\_\+ekf.\+cpp@{rollo\+\_\+ekf.\+cpp}}
\subsubsection[{z\+Pose2\+D\+Stamped}]{\setlength{\rightskip}{0pt plus 5cm}rollo\+::\+Pose2\+D\+Stamped z\+Pose2\+D\+Stamped}\label{rollo__ekf_8cpp_a09ad376aec92d33ec8b8e24e57a7d145}


Global variables updated in the Subscriber\+Callback functions. 

Initialize custom defined messages for meaurement and odometry. Measurement message includes Pose2\+D along with timestamp. Odometry message includes timestamp and angular velocities for left and right wheel. Initialize variables that save timestamps from both measurement and odometry subscribers in double (float64 in message format). 